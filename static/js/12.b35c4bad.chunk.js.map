{"version":3,"sources":["features/sign-in/components/SignInForm.js","features/sign-in/values/index.js","features/sign-in/containers/SignInFormContainer.js","features/sign-in/index.js","shared/auth/index.js"],"names":["SignInForm","values","touched","errors","isSubmitting","handleSubmit","handleChange","Form","onSubmit","noValidate","FormGroup","Label","for","Input","valid","email","type","name","id","placeholder","onChange","value","FormText","color","password","disabled","initialValues","validationSchema","object","shape","string","required","SignIn","history","useEffect","window","localStorage","getItem","push","PROFILE","useCallback","setSubmitting","setErrors","authDetails","AuthenticationDetails","Username","Password","cognitoUser","CognitoUser","Pool","userPool","authenticateUser","onSuccess","result","console","log","setItem","JSON","stringify","onFailure","error","message","newPasswordRequired","data","completeNewPasswordChallenge","this","Row","Col","md","size","offset","props","SignInFormContainer","CognitoUserPool","UserPoolId","process","ClientId","withAuthentication","AuthComponent","AuthContainer","auth","state","user","loggedIn","parse","to","SIGNIN","Component","connect","Selector","getUser"],"mappings":"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","file":"static/js/12.b35c4bad.chunk.js","sourcesContent":["import React from 'react';\n\nimport { Form, FormGroup, Label, Input, FormText } from 'reactstrap';\n\nimport { StyledFilledButton } from '../../../shared/styled';\n\nconst SignInForm = ({\n    values,\n    touched,\n    errors,\n    isSubmitting,\n    handleSubmit,\n    handleChange\n}) => (\n    <Form onSubmit={handleSubmit} noValidate>\n        <FormGroup>\n            <Label for=\"email\">E-mail</Label>\n            <Input valid={touched.email && !errors.email} type=\"email\" name=\"email\" id=\"email\" placeholder=\"user@example.com\" onChange={handleChange} value={values.email}/>\n            { errors.email && <FormText color=\"danger\">{errors.email}</FormText>}\n        </FormGroup>\n        <FormGroup>\n            <Label for=\"password\">Password</Label>\n            <Input valid={touched.email && !errors.password} type=\"password\" name=\"password\" id=\"password\" onChange={handleChange} value={values.password}/>\n            { errors.password && <FormText color=\"danger\">{errors.password}</FormText>}\n        </FormGroup>\n        <StyledFilledButton type=\"submit\" disabled={isSubmitting}>\n            Accedi\n        </StyledFilledButton>\n    </Form>\n)\n\nexport default SignInForm;","import { object, string } from 'yup';\n\nconst initialValues = {\n    email: '',\n    password: ''\n};\nconst validationSchema = object().shape(({\n    email: string().email('E-mail non valida').required('Inserire l\\'e-mail'),\n    password: string().required('Inserire la password')\n}));\n\nexport { initialValues, validationSchema };\n","import React, { useCallback, useEffect } from 'react';\n\nimport {\n    AuthenticationDetails,\n    CognitoUser\n  } from 'amazon-cognito-identity-js';\nimport { Formik } from 'formik';\nimport { Row, Col } from 'reactstrap';\n\nimport SignInForm from '../components';\n\nimport { initialValues, validationSchema } from '../values';\nimport { userPool } from '../../../shared/auth';\nimport { PROFILE } from '../../../config/routes';\n\nconst SignIn = ({ history }) => {\n    useEffect(() => {\n        const auth = window.localStorage.getItem('LoggedIn');\n\n        if (auth) {\n            history.push(PROFILE);\n        }\n    }, [history]);\n\n    const onSubmit = useCallback(({ email, password }, { setSubmitting, setErrors }) => {\n        const authDetails = new AuthenticationDetails({ Username: email, Password: password });\n        const cognitoUser = new CognitoUser({ Username: email, Pool: userPool });\n\n        cognitoUser.authenticateUser(authDetails, {\n            onSuccess(result) {\n                console.log(result);\n                window.localStorage.setItem('LoggedIn', JSON.stringify(result));\n                setSubmitting(false);\n                history.push(PROFILE);\n\n            },\n            onFailure(error) {\n                console.error(error);\n                setSubmitting(false);\n                setErrors({ password: error.message });\n            },\n            newPasswordRequired(data) {\n                console.log(data);\n                cognitoUser.completeNewPasswordChallenge(password, { name: email }, this);\n            }\n        });\n    }, [history]);\n\n    return (\n        <Row>\n            <Col md={{ size: 6, offset: 3 }}>\n                <Formik\n                    initialValues={initialValues}\n                    validationSchema={validationSchema}\n                    onSubmit={onSubmit}\n                >\n                    {props => <SignInForm {...props}/>}\n                </Formik>\n            </Col>\n        </Row>\n    );\n}\n\nexport default SignIn;\n","import React from 'react';\n\nimport SignInFormContainer from './containers'\n\nconst SignIn = ({ history }) => <SignInFormContainer history={history} />\n\nexport default SignIn;\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router-dom';\nimport { CognitoUserPool } from \"amazon-cognito-identity-js\";\n\nimport { SIGNIN } from '../../config/routes';\n\nimport { loggedIn } from '../../store/user/action';\nimport { Selector } from '../../store/user/reducer';\n\nconst withAuthentication = (AuthComponent) => {\n    class AuthContainer extends Component {\n        constructor(props) {\n            super(props);\n\n            const auth = window.localStorage.getItem('LoggedIn');\n            this.state = { auth };\n\n            if (auth && !this.props.user.data) {\n                this.props.loggedIn({ data: JSON.parse(this.state.auth) });\n            }\n        }\n\n        render() {\n            if (this.state.auth) {\n                return <AuthComponent />;\n            }\n\n            return <Redirect to={SIGNIN} />\n        }\n    }\n\n    return connect((state) => ({ user: Selector.getUser(state) }), { loggedIn })(AuthContainer);\n}\n\nconst userPool = new CognitoUserPool({\n    UserPoolId: process.env.REACT_APP_COGNITO_USER_POOL_ID,\n    ClientId: process.env.REACT_APP_COGNITO_CLIENT_ID\n});\n\nexport default withAuthentication;\n\nexport { userPool };\n"],"sourceRoot":""}